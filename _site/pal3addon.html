<!DOCTYPE html>
<html>
	<head>
		<meta charset='utf-8' />
		<title>
			仙剑3配音外挂-且慢
		</title>
		<link rel='stylesheet' href='style.css' />
    
      <style>#arch{color:white;}</style>
    
	</head>
	<body>
		<header>
			<nav>
			  <a href='/' id='main'>且慢</a>
				<a href='/archive.html' id='arch'>日志</a>
				<a href='/tag.html' id='tag'>标签</a>
        <a href='/resume.html' id='resume'>简历</a>
        <a href='/lab.html' id='lab'>宝贝</a>
			</nav>
		</header>
    <div id='content'>
      <article>
	<h3>仙剑3配音外挂</h3>
	<section>
		<time>2009-08-13</time>
		
		<a href='/tag.html#纪念'>#纪念</a>
		
		<a href='/tag.html#游戏'>#游戏</a>
		
	</section>
	<section>
		<p>遥想我高中的时候曾经妄想做一个外挂，让仙剑3配上对话语音。甚至为此还联系上了配音组。我的高中的时候果然是个开挂的年代。下面代码就是我从以前的博客上翻来的。毅然全部忘记。只留作纪念。</p>

<pre><code>Private Declare Function
  FindWindow Lib &quot;user32&quot; Alias &quot;FindWindowA&quot;
(ByVal lpClassName As String, ByVal lpWindowName As String) 
  As Long
  Private Declare Function
  GetWindowThreadProcessId Lib &quot;user32&quot;
  (ByVal hwnd As Long, lpdwProcessId As Long) As Long
  Private Declare Function
  OpenProcess Lib &quot;kernel32&quot;
  (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long
  Private Const PROCESS_ALL_ACCESS = &amp;H1F0FFF
  Private Declare Function ReadProcessMemory Lib &quot;kernel32&quot; (ByVal hProcess As Long, 
      lpBaseAddress As Any, 
      lpBuffer As Any, 
      ByVal nSize As Long, 
      lpNumberOfBytesWritten As Long) As Long
  Private Declare Function
  CloseHandle Lib &quot;kernel32&quot; (ByVal hObject As Long) As Long
  Dim c As Integer
  Dim t1, t2, t3, t4, o As Long
  Dim t, a As Long
  Dim k As Boolean


Private Sub Form_Load()
  t = 0
  k = True
  t4 = 0
  &#39;Open App.Path &amp; &quot;\1.txt&quot; For Output As #1

  &#39;Input #1, c, b
  End Sub

Private Sub Timer1_Timer()
  Text1.Text = k
  Text2.Text = o
  Text3.Text = t4
  Text4.Text = a
  t1 = FindWindow(vbNullString, &quot;PAL3--SOFTSTAR.sh&quot;)
  GetWindowThreadProcessId t1, t2
t3 = OpenProcess(PROCESS_ALL_ACCESS, False, t2)
  ReadProcessMemory t3, ByVal &amp;HDBA1A8, o, 4, 0&amp;
  ReadProcessMemory t3, ByVal o + &amp;H8, o, 4, 0&amp;
  &#39;ReadProcessMemory t3, ByVal &amp;H2797164, s, 4, 0&amp;
  If o = -272571691 And k Then &#39;s - t = 1
  Open App.Path &amp; &quot;\saygoodbye.txt&quot; For Input As #1 
  &#39;正式的应该读相应的文件此处省略
  MMControl1.Notify = False
  MMControl1.Wait = True
  MMControl1.Shareable = False
  MMControl1.DeviceType = &quot;WaveAudio&quot;
  MMControl1.FileName = App.Path &amp; &quot;\f.wav&quot;
  MMControl1.Command = &quot;Open&quot;
  MMControl1.TimeFormat = 10
  k = False
  End If
  &#39;t = s
  If (Not k) And Not (t4 = o) Then
  t4 = o
  MMControl1.Command = &quot;stop&quot;
  b = a
  Input #1, a
  If a &lt;&gt; 35001 Then
  If a &lt;&gt; 999 Then
  MMControl1.From = b
  MMControl1.To = a
  MMControl1.Command = &quot;play&quot;
  &#39;Close file
  &#39;close music
  Else
  MMControl1.To = MMControl1.Length
  MMControl1.Command = &quot;play&quot;
  End If
  End If
  End If
  Text5.Text = MMControl1.Position
  &#39;If re = -272571691 Or ok = 1 Then ok = 1
  &#39;If MMControl1.Position = a Then
  &#39;MMControl1.Command = &quot;pause&quot;
  &#39;End If
  &#39;If ok = 1 Then
  &#39;If t4 &lt;&gt; re Then
  &#39;t4 = re
  &#39;Input #1, a
  &#39;Text1.Text = MMControl1.Position
  &#39;If a &lt;&gt; 0 And a &lt;&gt; &quot;end&quot; Then
  &#39;MMControl1.Command = &quot;play&quot;
  &#39;Else
  &#39;If k = &quot;end&quot; Then
  &#39;Timer1.Interval = False
  &#39;End If
  &#39;End If
  &#39;End If
  &#39;End If
  End Sub
  &#39;Print #1, c; re</code></pre>
	</section>
<!-- Duoshuo Comment BEGIN -->
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"waksana"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- Duoshuo Comment END -->
</article>

    </div>
		<footer></footer>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fd764d28cada8e1a7a6f120030c2faf6d' type='text/javascript'%3E%3C/script%3E"));
</script>
	</body>
</html>
